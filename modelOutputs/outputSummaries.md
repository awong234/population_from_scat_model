# First run 2018-08-01

Priors were:

$\theta = \exp(\theta_{00})$ ; 
$\theta_{00} \sim \text{Normal}(0, 0.01)$

$\lambda = \exp(\lambda_{0})$ ;
$\lambda_0 \sim \text{Normal}(0, 0.01)$

$p_{00} \sim \text{Uniform}(0,1)$

This was deemed a little too informative by me, so I adjusted the priors in later runs after 0805.

Starting value was set only for the scat population vector, such that the initial value was the sum of all scats ever encountered; this must be minimally true to begin the analysis. No other parameters were set.

```
JAGS output for model 'model_null.txt', generated by jagsUI.
Estimates based on 4 chains of 1e+05 iterations,
burn-in = 25000 iterations and thin rate = 1,
yielding 3e+05 total samples from the joint posterior. 
MCMC ran in parallel for 5071.052 minutes at time 2018-07-29 09:17:08.

             mean      sd     2.5%      50%    97.5% overlap0 f  Rhat n.eff
theta00    -6.976   0.081   -7.121   -6.983   -6.815    FALSE 1 1.842     7
p00         0.593   0.039    0.520    0.590    0.664    FALSE 1 2.213     6
lambda0    -2.912   0.109   -3.144   -2.885   -2.750    FALSE 1 2.623     5
deviance 1816.932 153.927 1552.600 1824.991 2106.958    FALSE 1 2.294     6

**WARNING** Rhat values indicate convergence failure. 
Rhat is the potential scale reduction factor (at convergence, Rhat=1). 
For each parameter, n.eff is a crude measure of effective sample size. 

overlap0 checks if 0 falls in the parameter's 95% credible interval.
f is the proportion of the posterior with the same sign as the mean;
i.e., our confidence that the parameter is positive or negative.

DIC info: (pD = var(deviance)/2) 
pD = 4220 and DIC = 6036.931 
DIC is an estimate of expected predictive error (lower is better).
```

## Trace plots

![lambda](../images/lambda0_0802.png)
![theta](../images/theta00_0802.png)
![p0](../images/p0_0802.png)

# Update 2018-08-05

Note: traceplots show only last 1e5 updated iterations. Same priors as before. Mixing better, but still poor for most parameters.

```
JAGS output for model 'model_null.txt', generated by jagsUI.
Estimates based on 4 chains of 2e+05 iterations,
burn-in = 1e+05 iterations and thin rate = 1,
yielding 4e+05 total samples from the joint posterior. 
MCMC ran in parallel for 3641.78 minutes at time 2018-08-02 13:05:13.

             mean      sd     2.5%      50%    97.5% overlap0 f  Rhat n.eff
theta00    -6.982   0.078   -7.120   -6.991   -6.821    FALSE 1 1.832     7
p00         0.620   0.031    0.557    0.622    0.676    FALSE 1 1.549     9
lambda0    -2.936   0.094   -3.137   -2.920   -2.783    FALSE 1 2.209     6
deviance 1705.003 115.597 1509.407 1693.191 1944.163    FALSE 1 1.687     8

**WARNING** Rhat values indicate convergence failure. 
Rhat is the potential scale reduction factor (at convergence, Rhat=1). 
For each parameter, n.eff is a crude measure of effective sample size. 

overlap0 checks if 0 falls in the parameter's 95% credible interval.
f is the proportion of the posterior with the same sign as the mean;
i.e., our confidence that the parameter is positive or negative.

DIC info: (pD = var(deviance)/2) 
pD = 3683.9 and DIC = 5388.952 
DIC is an estimate of expected predictive error (lower is better).
```

## Traceplots 

![lambda](../images/lambda0_0805.png)
![theta](../images/theta00_0805.png)
![p00](../images/p00_0805.png)

# New run 2018-08-06

Dana recommended longer adaptation period. Results are *much* more promising even after 10,000 iterations, as opposed to the previous 200,000, mixing much improved. Upon receiving this result, the chains have been set to update another $3e4$ iterations.

Priors were made more uninformative by changing:

$\theta = \exp(\theta_{00})$ ; 
$\theta_{00} \sim \text{Uniform}(-10, 5)$

$\lambda = \exp(\lambda_{0})$ ; 
$\lambda_{0} \sim \text{Uniform}(-10, 5)$

$\exp(-10)$ was deemed to be a sufficient lower bound. I am using exponentiated normal distribution because mean theta and lambda are expected to be very small numbers. The upper bound was chosen to be an impossibly large number. 

Starting values were set to the following:

`N[g,1,v]` was kept as the sum of all `rowSums(y[g,t,v])`; that is, all scats ever encountered; this a minimally true case for the algorithm to begin.
`theta0[g,t] = -6`, based on previous run of 200,000 iterations.
`lambda0[g,t] = -4`, based on previous run of 200,000 iterations.

Settings below:

`n.adapt = 10000`

`n.iter = 10000`

`n.burn = 1000`

```
JAGS output for model 'model_null.txt', generated by jagsUI.
Estimates based on 4 chains of 10000 iterations,
burn-in = 1000 iterations and thin rate = 1,
yielding 36000 total samples from the joint posterior. 
MCMC ran in parallel for 910.594 minutes at time 2018-08-06 11:53:04.

             mean      sd     2.5%      50%    97.5% overlap0 f  Rhat n.eff
theta00    -7.112   0.070   -7.251   -7.111   -6.976    FALSE 1 1.084    36
p00         0.458   0.031    0.397    0.458    0.517    FALSE 1 1.491     9
lambda0    -2.631   0.069   -2.764   -2.632   -2.498    FALSE 1 1.342    12
deviance 2408.011 140.285 2155.749 2405.060 2684.612    FALSE 1 1.621     8

**WARNING** Rhat values indicate convergence failure. 
Rhat is the potential scale reduction factor (at convergence, Rhat=1). 
For each parameter, n.eff is a crude measure of effective sample size. 

overlap0 checks if 0 falls in the parameter's 95% credible interval.
f is the proportion of the posterior with the same sign as the mean;
i.e., our confidence that the parameter is positive or negative.

DIC info: (pD = var(deviance)/2) 
pD = 5645.2 and DIC = 8053.261 
DIC is an estimate of expected predictive error (lower is better).
```
## Traceplots

<center><b>Notice: this is on 1/20th the amount of iterations!</b></center>

![lambda](../images/lambda0_0806.png)
![theta](../images/theta00_0806.png)
![p00](../images/p00_0806.png)

## Posterior distributions

### Theta

![theta](../images/0806_postDensTheta.png)

### Lambda 

![lambda](../images/0806_postDensLambda.png)

### p

![p](../images/0806_postDensP.png)

## How many moose? 

If the daily defecation rate per 2500 m<sup>2</sup> is $\exp(-7.112) = 0.00081$, and the Adirondacks has an area of 2.4281E+10 m<sup>2</sup>, at a mean defecation rate of 13 per day, this evaluates to 609 moose, with an interval from 530 to 698 moose, for the period of time during which we sampled. Do note that precision is artificially high due to assumption of independence between grid cells, which will be addressed with a geostatistical covariance structure for spatial effect, or CAR structure.

Cut out all uninhabitable areas such as human development and water, and the interval is 

 464 - 534 - 612